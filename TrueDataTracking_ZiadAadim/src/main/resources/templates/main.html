<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Character Illustration Trainer</title>
    <link rel="stylesheet" th:href="@{/css/css/styles.css}">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="static/css/js/scripts.js"></script>
</head>
<body>
<div class="container">
    <h1>Character Illustration Trainer</h1>
    <h2>Select a Course</h2>
    <div class="course-wrapper">
        <a href="/course/anatomy" class="course-card" onclick="logCardClick(event, 'Main page', 'Anatomy')">
            <div class="image-placeholder"></div>
            <div class="course-info">
                <h3>Anatomy</h3>
                <p>Learn about the structure of the human body and its parts.</p>
            </div>
        </a>
        <a href="/course/perspective" class="course-card" onclick="logCardClick(event, 'Main page', 'Perspective')">
            <div class="image-placeholder"></div>
            <div class="course-info">
                <h3>Perspective</h3>
                <p>Master the techniques of creating depth and perspective in art.</p>
            </div>
        </a>
        <a href="/course/gesture" class="course-card" onclick="logCardClick(event, 'Main page', 'Gesture')">
            <div class="image-placeholder"></div>
            <div class="course-info">
                <h3>Gesture</h3>
                <p>Improve your ability to capture poses and motion in drawings.</p>
            </div>
        </a>
        <div class="course-card coming-soon" onclick="logCardClick(event, 'Main page', 'Coming soon')">
            <div class="image-placeholder"></div>
            <div class="course-info">
                <h3>References</h3>
                <p>Input references you would like to draw and train on.</p>
            </div>
            <div class="coming-soon-label">Coming Soon</div>
        </div>
    </div>
</div>
<div id="terms-modal" class="modal">
    <div class="modal-content">
        <h3>Terms of Use</h3>
        <p>
            By using this application, you agree to the tracking of your interactions
            to enhance user experience and improve the app.
            Your data will remain anonymous and will only be used for analytics.
        </p>
        <label>
            <input type="checkbox" id="accept-terms"> I accept the terms of use
        </label>
        <button id="continue-btn" disabled>Continue</button>
    </div>
</div>
 <script>
     window.addEventListener('load', () => {
         // Check if the modal has already been shown in this session
         if (!sessionStorage.getItem('termsModalShown')) {
             setTimeout(() => {
                 const modal = document.getElementById('terms-modal');
                 if (modal) {
                     modal.style.display = 'flex'; // Show the modal
                     sessionStorage.setItem('termsModalShown', 'true'); // Set flag
                 } else {
                     console.error('Modal element not found');
                 }
             }, 2000); // Wait for 3 seconds
         }
     });

     // Enable the Continue button when the checkbox is checked
     document.addEventListener('DOMContentLoaded', () => {
         const checkbox = document.getElementById('accept-terms');
         const continueBtn = document.getElementById('continue-btn');

         if (checkbox && continueBtn) {
             checkbox.addEventListener('change', () => {
                 console.log('Checkbox state changed:', checkbox.checked); // Debugging log
                 continueBtn.disabled = !checkbox.checked; // Enable button if checked
             });
         } else {
             console.error('Checkbox or continue button not found');
         }

         // Close the modal and proceed
         continueBtn.addEventListener('click', () => {
             document.getElementById('terms-modal').style.display = 'none';
         });
     });


         // General event logger for all course cards
         function logCardClick(event, page, section) {
         event.preventDefault(); // Prevent navigation
         const data = {
         eventType: "BUTTON_CLICK",
         page: page,
         buttonClicked: section,
         timestamp: new Date().toISOString(),
         userId: "dummy_user" // Replace with actual user ID if available
     };

         fetch('/api/events/log', {
         method: 'POST',
         headers: {
         'Content-Type': 'application/json'
     },
         body: JSON.stringify(data)
     })
         .then(response => {
         if (response.ok) {
         console.log(`${section} click logged on page: ${page}`);
     } else {
         console.error("Failed to log click event.");
     }
     })
         .catch(error => console.error("Error logging click:", error));

         // Navigate to the link after logging
         const href = event.target.closest("a").getAttribute("href");
         if (href) {
         window.location.href = href;
     }
     }

</script>

</body>
</html>


